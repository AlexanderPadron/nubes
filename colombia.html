<html>
    <body>
        <!-- <a href="https://sx-b2c.segurosfalabella.com/VIDA_COLOMBIA/pos/flow/VIDA/7">Vida Colombia</a> -->
        <div class="col-12 col-md-6 text-center product-banner--info-container pb40 pb-md-0 pr20 pl20">
            <a href="https://sx-b2c.segurosfalabella.com/VIDA_ASESORADO_CO/login">Vida Asesorado Colombia</a>
        </div>
        
        <hr>
   
    <iframe src="https://sx-b2c.segurosfalabella.com/ligth_CO.html" id="sox" frameborder="0" width="0" height="0"></iframe>
    </body>
    <script>
	document.write('El navegador detectado es: ' + navigator.userAgent);
        var isSafari = navigator.vendor && navigator.vendor.indexOf('Apple') > -1 &&
               navigator.userAgent &&
               navigator.userAgent.indexOf('CriOS') == -1 &&
               navigator.userAgent.indexOf('FxiOS') == -1;
	var theLinks = document.querySelectorAll('.product-banner--info-container a');
	var theLinks2 = document.querySelectorAll('.product-banner--info-container a');
	console.log('MS isSafari', isSafari)
	if(!isSafari && (navigator.userAgent.match(/iPhone/i) && navigator.userAgent.match(/Firefox/i))) {
	  console.log('MS', 'detectamos iphone')
	  isSafari = true
	}
	if(!isSafari){
	  console.log('MS', 'no es safari, buscamos setear la url')
	    theLinks.forEach(function (element, index) {
		element.href = "https://sx-b2c.segurosfalabella.com/VIDA_ASESORADO_CO/pos/flow/VIDA/7";
	    });
	}

	window.addEventListener('message', function(event) {
	  if(event.origin === 'https://sx-b2c.segurosfalabella.com') {
	    console.log('MS', 'Recibimos el evento desde el iframe')
	    var bandera = false
	    for(var i = 0; i < event.data.message.length; i++) {
	      if(!bandera && event.data.message[i].jwtToken_VIDA_ASESORADO_CO) bandera = true
	    }
	    if(!isSafari && bandera) {
	      console.log('MS', 'el token se creo procedemos a cambiar la url')
	      theLinks2.forEach(function (element, index) {
		console.log('MS', 'Aqui esta', element)
		element.href = "https://sx-b2c.segurosfalabella.com/VIDA_ASESORADO_CO/pos/flow/VIDA/7";
	      });
	    } else {
	    	console.log('Al parecer es safari o iphone, pasaremos por las nubes')
	    }
	  }
	})
    </script>
</html>
